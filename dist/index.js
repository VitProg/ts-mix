"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const mixinsAfterInit="__afterMixins";class MixinAssertError extends Error{}function haveMixin(i,e,n){return"object"==typeof i&&"mixins"in i&&"object"==typeof i.mixins&&e.mixinName in i.mixins&&"object"==typeof i.mixins[e.mixinName]}function haveMixins(i,e,n){if(!("object"==typeof i&&"mixins"in i&&"object"==typeof i.mixins))return!1;for(const n of e)if(!1===haveMixin(i,n))return!1;return!0}function isMixin(i){var e,n,t,o,s,r,x;return"object"==typeof i&&"string"==typeof(null===(e=i)||void 0===e?void 0:e.mixinName)&&"object"==typeof(null===(n=i)||void 0===n?void 0:n.target)&&"object"==typeof(null===(o=null===(t=i)||void 0===t?void 0:t.target)||void 0===o?void 0:o.mixins)&&(null===(s=i)||void 0===s?void 0:s.mixinName)in(null===(x=null===(r=i)||void 0===r?void 0:r.target)||void 0===x?void 0:x.mixins)}function assertHaveMixin(i,e,n,t){if(!1===haveMixin(i,e))throw t instanceof Error?t:new MixinAssertError(null!=t?t:`The object does not have mixin '${e.mixinName}'`)}function assertHaveMixins(i,e,n,t){if(!1===haveMixins(i,e))throw t instanceof Error?t:new MixinAssertError(null!=t?t:`The object does not have one or more of mixins ${e.map(i=>`'${i.mixinName}'`).join(", ")}`)}function mixin(i){const e=i;return Object.assign({target:void 0},e)}function useMixinsForObject(i,e,n,t,o,s,r,x,a,f,c){return applyMixinsInternal(i,!0,e,n,t,o,s,r,x,a,f,c),i}function useMixins(i,e,n,t,o,s,r,x,a,f,c){var u;return(u=class extends i{constructor(...i){super(...i),applyMixinsInternal(this,!0,e,n,t,o,s,r,x,a,f,c)}}).__m_b_type=i,u}function applyMixins(i,...e){return applyMixinsInternal(i,!1,...e)}function mixingProps(i,e,n){for(const t of Object.keys(i)){const o=i[t];if(!(t in e))if("function"==typeof o.value)Reflect.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!1,value:(...i)=>n[t](...i)});else if(o.get||o.set){const i={enumerable:!1,configurable:!0};o.get&&(i.get=function(){return n[t]}),o.set&&(i.set=function(i){n[t]=i}),Reflect.defineProperty(e,t,i)}else Reflect.defineProperty(e,t,{enumerable:!1,configurable:!0,get:()=>n[t],set(i){n[t]=i}})}}function applyMixinsInternal(i,e,...n){"object"!=typeof i.mixins&&(i.mixins={}),n=n.filter(i=>!!i);for(const e of n){const n=Object.assign({},e),t=n.mixinName;i.mixins[t]=n,n.target=i}for(const n of Object.values(i.mixins)){if("setup"in n&&"function"==typeof n.setup){const i=n.setup();if(void 0!==i)for(const[e,t]of Object.entries(i))n[e]=t}if(e){mixingProps(getMixables(n),i,n)}}for(const e of Object.values(i.mixins))e.init&&e.init();mixinsAfterInit in i&&"function"==typeof i[mixinsAfterInit]&&i[mixinsAfterInit]()}const noPermitenMixableProperties=["__proto__","init","setup","target","mixinName"];function getMixables(i){const e={},n=Object.getOwnPropertyNames(i).filter(i=>!1===noPermitenMixableProperties.includes(i));for(const t of n){const n=Object.getOwnPropertyDescriptor(i,t);void 0!==n&&(e[t]=n)}return e}exports.MixinAssertError=MixinAssertError,exports.applyMixins=applyMixins,exports.assertHaveMixin=assertHaveMixin,exports.assertHaveMixins=assertHaveMixins,exports.haveMixin=haveMixin,exports.haveMixins=haveMixins,exports.isMixin=isMixin,exports.mixin=mixin,exports.useMixins=useMixins,exports.useMixinsForObject=useMixinsForObject;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbIi4uL3NyYy90eXBlcy50cyIsIi4uL3NyYy90eXBlLWd1YXJkcy50cyIsIi4uL3NyYy9taXhpbi50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiB0c2xpbnQ6ZGlzYWJsZTptYXgtbGluZS1sZW5ndGggaW50ZXJmYWNlLW92ZXItdHlwZS1saXRlcmFsICovXG5pbXBvcnQge0wsIE59IGZyb20gJ3RzLXRvb2xiZWx0JztcblxuZXhwb3J0IHR5cGUgQW55T2JqZWN0ID0gUmVjb3JkPHN0cmluZywgYW55PjtcbmV4cG9ydCB0eXBlIEFycmF5VmFsdWVzPG9iaiBleHRlbmRzIGFueVtdIHwgUmVhZG9ubHlBcnJheTxhbnk+PiA9XG4gICAgb2JqW251bWJlcl07XG5leHBvcnQgdHlwZSBVbmlvblRvSW50ZXJzZWN0aW9uPFVuaW9uPiA9XG4gICAgKFVuaW9uIGV4dGVuZHMgYW55ID8gKHg6IFVuaW9uKSA9PiB2b2lkIDogbmV2ZXIpIGV4dGVuZHMgKCh4OiBpbmZlciBpbnRlcnNlY3Rpb24pID0+IHZvaWQpXG4gICAgICAgID8gaW50ZXJzZWN0aW9uXG4gICAgICAgIDogbmV2ZXI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSU1peGluQmFzZTxOYW1lIGV4dGVuZHMgc3RyaW5nPiB7XG4gICAgbWl4aW5OYW1lOiBOYW1lO1xuICAgIGluaXQ/KCk6IHZvaWQ7XG4gICAgc2V0dXA/KCk6IEFueU9iamVjdDsgLy8gdG9kb1xuICAgIHRhcmdldDogTWl4aW5UYXJnZXQ8SU1peGluQmFzZTxOYW1lPj47XG59XG5cblxuZXhwb3J0IHR5cGUgTWl4aW48TmFtZSBleHRlbmRzIHN0cmluZywgQ29uZmlnIGV4dGVuZHMgQW55T2JqZWN0PiA9IENvbmZpZyAmIElNaXhpbkJhc2U8TmFtZT47XG5leHBvcnQgdHlwZSBNaXhpbkZ1bGw8TmFtZSBleHRlbmRzIHN0cmluZywgQ29uZmlnIGV4dGVuZHMgQW55T2JqZWN0PiA9IE9taXQ8SU1peGluQmFzZTxOYW1lPiwgJ3RhcmdldCc+ICYgQ29uZmlnICYge3RhcmdldDogQW55T2JqZWN0ICYgSVVzZU1peGluczxBbnlPYmplY3QsIE1peGluPE5hbWUsIENvbmZpZz4+fTtcbmV4cG9ydCB0eXBlIE1peGluVGhpczxDb25maWcgZXh0ZW5kcyBBbnlPYmplY3Q+ID0gTWl4aW5GdWxsPGFueSwgQ29uZmlnPjtcblxudHlwZSBNYWtlTWl4aW5JdGVtPFg+ID1cbiAgICBYIGV4dGVuZHMgSU1peGluQmFzZTxpbmZlciBOYW1lPlxuICAgICAgICA/IFJlY29yZDxOYW1lLCBYPlxuICAgICAgICA6IG5ldmVyO1xuXG5leHBvcnQgdHlwZSBNaXhpbnNQcm9wPE1peGlucyBleHRlbmRzIFJlYWRvbmx5QXJyYXk8TWl4aW48YW55LCBhbnk+Pj4gPVxuICAgIFVuaW9uVG9JbnRlcnNlY3Rpb248QXJyYXlWYWx1ZXM8eyBbaSBpbiBrZXlvZiBNaXhpbnNdOiBNYWtlTWl4aW5JdGVtPE1peGluc1tpXT4gfT4+O1xuXG5cbmV4cG9ydCB0eXBlIEFueU1peGluID0gTWl4aW48YW55LCBhbnk+O1xuZXhwb3J0IHR5cGUgQW55TWl4aW5SZWNvcmQgPSBSZWNvcmQ8c3RyaW5nLCBBbnlNaXhpbj47XG5cbnR5cGUgRXh0cmFjdENsYXNzRmllbGRzPENsYXNzPiA9ICBrZXlvZiAoXG4gICAgQ2xhc3MgZXh0ZW5kcyB7X19tX2JfdHlwZTogQ29uc3RydWN0b3I8aW5mZXIgSj59ID8gSiA6IChcbiAgICAgICAgQ2xhc3MgZXh0ZW5kcyBDb25zdHJ1Y3Rvcjxhbnk+ID8gSW5zdGFuY2VUeXBlPENsYXNzPiA6XG4gICAgICAgICAgICBDbGFzc1xuICAgICAgICApKTtcblxuZXhwb3J0IHR5cGUgSVVzZU1peGluczxcbiAgICBDbGFzcyBleHRlbmRzIEFueU9iamVjdCxcbiAgICBNMSBleHRlbmRzIE1peGluPGFueSwgYW55PixcbiAgICBNMiBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE0zIGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4gICAgTTQgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNNSBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE02IGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4gICAgTTcgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNOCBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE05IGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4gICAgTTEwIGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4+ID0gKENsYXNzIGV4dGVuZHMgQ29uc3RydWN0b3I8aW5mZXIgSj4gPyBKIDogQ2xhc3MpICZcbiAgICBPbWl0PEJ1aWxkTWl4aW5zSW50ZXJzZWN0aW9uPE0xLCBNMiwgTTMsIE00LCBNNSwgTTYsIE03LCBNNywgTTksIE0xMD4sIEV4dHJhY3RDbGFzc0ZpZWxkczxDbGFzcz4+ICZcbiAgICBNaXhpbnNQcm9wT2JqZWN0PE0xLCBNMiwgTTMsIE00LCBNNSwgTTYsIE03LCBNOCwgTTksIE0xMD47XG5cbmV4cG9ydCB0eXBlIE1peGluc1Byb3BPYmplY3Q8XG4gICAgTTEgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4sXG4gICAgTTIgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNMyBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE00IGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4gICAgTTUgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNNiBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE03IGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4gICAgTTggZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNOSBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE0xMCBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuPiA9IHttaXhpbnM6IE1peGluc1Byb3A8W00xLCBNMiwgTTMsIE00LCBNNSwgTTYsIE03LCBNOCwgTTksIE0xMF0+ICYgQW55TWl4aW5SZWNvcmR9O1xuXG5cbmV4cG9ydCB0eXBlIEV4dHJhY3RNaXhpbnNQcm9wPFQ+ID0gVCBleHRlbmRzIHttaXhpbnM6IGFueX0gPyBUWydtaXhpbnMnXSA6IHt9O1xuXG5leHBvcnQgdHlwZSBCdWlsZE1peGluc0ludGVyc2VjdGlvbjxcbiAgICBNMSBleHRlbmRzIE1peGluPGFueSwgYW55PixcbiAgICBNMiBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE0zIGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4gICAgTTQgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNNSBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE02IGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4gICAgTTcgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNOCBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE05IGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4gICAgTTEwIGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4+ID1cbiAgICBNMSAmXG4gICAgQ2hlY2tOZXZlcjxNMixcbiAgICAgICAgQ2hlY2tOZXZlcjxNMyxcbiAgICAgICAgICAgIENoZWNrTmV2ZXI8TTQsXG4gICAgICAgICAgICAgICAgQ2hlY2tOZXZlcjxNNSxcbiAgICAgICAgICAgICAgICAgICAgQ2hlY2tOZXZlcjxNNixcbiAgICAgICAgICAgICAgICAgICAgICAgIENoZWNrTmV2ZXI8TTcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2hlY2tOZXZlcjxNOCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2hlY2tOZXZlcjxNOSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENoZWNrTmV2ZXI8TTEwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9taXQ8TTEwLCBrZXlvZiBNMTAgfCBrZXlvZiBNOCB8IGtleW9mIE03IHwga2V5b2YgTTYgfCBrZXlvZiBNNSB8IGtleW9mIE00IHwga2V5b2YgTTMgfCBrZXlvZiBNMiB8IGtleW9mIE0xIHwgJ21peGluTmFtZScgfCAndGFyZ2V0JyB8ICdpbml0JyB8ICdzZXR1cCcgfCAnX191c2VkX21peGlucyc+LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9taXQ8TTksIGtleW9mIE04IHwga2V5b2YgTTcgfCBrZXlvZiBNNiB8IGtleW9mIE01IHwga2V5b2YgTTQgfCBrZXlvZiBNMyB8IGtleW9mIE0yIHwga2V5b2YgTTEgfCAnbWl4aW5OYW1lJyB8ICd0YXJnZXQnIHwgJ2luaXQnIHwgJ3NldHVwJyB8ICdfX3VzZWRfbWl4aW5zJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPbWl0PE04LCBrZXlvZiBNNyB8IGtleW9mIE02IHwga2V5b2YgTTUgfCBrZXlvZiBNNCB8IGtleW9mIE0zIHwga2V5b2YgTTIgfCBrZXlvZiBNMSB8ICdtaXhpbk5hbWUnIHwgJ3RhcmdldCcgfCAnaW5pdCcgfCAnc2V0dXAnIHwgJ19fdXNlZF9taXhpbnMnPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPbWl0PE03LCBrZXlvZiBNNiB8IGtleW9mIE01IHwga2V5b2YgTTQgfCBrZXlvZiBNMyB8IGtleW9mIE0yIHwga2V5b2YgTTEgfCAnbWl4aW5OYW1lJyB8ICd0YXJnZXQnIHwgJ2luaXQnIHwgJ3NldHVwJyB8ICdfX3VzZWRfbWl4aW5zJz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9taXQ8TTYsIGtleW9mIE01IHwga2V5b2YgTTQgfCBrZXlvZiBNMyB8IGtleW9mIE0yIHwga2V5b2YgTTEgfCAnbWl4aW5OYW1lJyB8ICd0YXJnZXQnIHwgJ2luaXQnIHwgJ3NldHVwJyB8ICdfX3VzZWRfbWl4aW5zJz5cbiAgICAgICAgICAgICAgICAgICAgICAgID4sXG4gICAgICAgICAgICAgICAgICAgICAgICBPbWl0PE01LCBrZXlvZiBNNCB8IGtleW9mIE0zIHwga2V5b2YgTTIgfCBrZXlvZiBNMSB8ICdtaXhpbk5hbWUnIHwgJ3RhcmdldCcgfCAnaW5pdCcgfCAnc2V0dXAnIHwgJ19fdXNlZF9taXhpbnMnPlxuICAgICAgICAgICAgICAgICAgICA+LFxuICAgICAgICAgICAgICAgICAgICBPbWl0PE00LCBrZXlvZiBNMyB8IGtleW9mIE0yIHwga2V5b2YgTTEgfCAnbWl4aW5OYW1lJyB8ICd0YXJnZXQnIHwgJ2luaXQnIHwgJ3NldHVwJyB8ICdfX3VzZWRfbWl4aW5zJz5cbiAgICAgICAgICAgICAgICA+LFxuICAgICAgICAgICAgICAgIE9taXQ8TTMsIGtleW9mIE0yIHwga2V5b2YgTTEgfCAnbWl4aW5OYW1lJyB8ICd0YXJnZXQnIHwgJ2luaXQnIHwgJ3NldHVwJyB8ICdfX3VzZWRfbWl4aW5zJz5cbiAgICAgICAgICAgID4sXG4gICAgICAgICAgICBPbWl0PE0yLCBrZXlvZiBNMSB8ICdtaXhpbk5hbWUnIHwgJ3RhcmdldCcgfCAnaW5pdCcgfCAnc2V0dXAnIHwgJ19fdXNlZF9taXhpbnMnPlxuICAgICAgICA+LFxuICAgICAgICB7fVxuICAgICAgICA+O1xuXG5cblxuZXhwb3J0IHR5cGUgQ2hlY2tOZXZlcjxULCBJZk5vdE5ldmVyLCBJZk5ldmVyID0gbmV2ZXI+ID0gW1RdIGV4dGVuZHMgW25ldmVyXSA/IElmTmV2ZXIgOiBJZk5vdE5ldmVyO1xuXG5cbmV4cG9ydCB0eXBlIE1peGluVGFyZ2V0PE0gZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4+ID0gQW55T2JqZWN0ICYgSVVzZU1peGluczxBbnlPYmplY3QsIE0+O1xuXG5cbmV4cG9ydCBjb25zdCBtaXhpbnNBZnRlckluaXQgPSAnX19hZnRlck1peGlucyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSU1peGluQWZ0ZXJJbml0SGFuZGxlciB7XG4gICAgX19hZnRlck1peGluczogKCkgPT4gdm9pZDtcbn1cblxuXG4vLy8vLy8vLy8vLy8vLy8vXG5cblxuXG5leHBvcnQgY2xhc3MgTWl4aW5Bc3NlcnRFcnJvciBleHRlbmRzIEVycm9yIHt9XG5cblxuZXhwb3J0IHR5cGUgQ29uZmlnQ29tcGxleDxOYW1lIGV4dGVuZHMgc3RyaW5nLCBDb25maWcgZXh0ZW5kcyBBbnlPYmplY3QsIFBhcnRpYWxLZXlzIGV4dGVuZHMgQXJyYXk8a2V5b2YgQ29uZmlnPiA9IFtdPlxuICAgID0gUGFydGlhbEJ5PENvbmZpZywgT1I8UGFydGlhbEtleXM+PiAmXG4gICAgeyBtaXhpbk5hbWU6IE5hbWUsIGluaXQ/OiAoKSA9PiB2b2lkIH0gJlxuICAgIChPUjxQYXJ0aWFsS2V5cz4gZXh0ZW5kcyBuZXZlciA/IHt9IDogeyBzZXR1cDogKCkgPT4gUmVxdWlyZWQ8UGljazxDb25maWcsIE9SPFBhcnRpYWxLZXlzPj4+IH0pO1xudHlwZSBQYXJ0aWFsQnk8VCwgSyBleHRlbmRzIGtleW9mIFQ+ID0gT21pdDxULCBLPiAmIFBhcnRpYWw8UGljazxULCBLPj47XG50eXBlIE9SPFQgZXh0ZW5kcyBSZWFkb25seUFycmF5PGFueT4+ID0gVFtudW1iZXJdO1xuXG5cbmV4cG9ydCB0eXBlIENvbnN0cnVjdG9yPFQsIEEgZXh0ZW5kcyBhbnlbXSA9IGFueVtdPiA9IG5ldyAoLi4uYXJnczogQSkgPT4gVDtcblxuZXhwb3J0IHR5cGUgRXh0cmFjdFN0YXRpYzxUIGV4dGVuZHMgQW55T2JqZWN0PiA9IENoZWNrTmV2ZXI8RXhjbHVkZTxrZXlvZiBULCAncHJvdG90eXBlJz4sIE9taXQ8e1trZXkgaW4ga2V5b2YgVF06IFRba2V5XX0sICdwcm90b3R5cGUnPj47XG5cbmV4cG9ydCB0eXBlIENvbnN0cnVjdG9yV2l0aFN0YXRpYzxULCBDdG9yIGV4dGVuZHMgQ29uc3RydWN0b3I8YW55Pj4gPVxuICAgIENoZWNrTmV2ZXI8XG4gICAgICAgIEV4Y2x1ZGU8a2V5b2YgQ3RvciwgJ3Byb3RvdHlwZSc+LFxuICAgICAgICBDb25zdHJ1Y3RvcjxULCBDb25zdHJ1Y3RvclBhcmFtZXRlcnM8Q3Rvcj4+ICYgRXh0cmFjdFN0YXRpYzxDdG9yPixcbiAgICAgICAgQ29uc3RydWN0b3I8VCwgQ29uc3RydWN0b3JQYXJhbWV0ZXJzPEN0b3I+PlxuICAgID47XG4iLCJpbXBvcnQge0FueU9iamVjdCwgQ2hlY2tOZXZlciwgQ29uc3RydWN0b3IsIElNaXhpbkJhc2UsIElVc2VNaXhpbnMsIE1peGluLCBNaXhpbkFzc2VydEVycm9yLCBNaXhpbnNQcm9wT2JqZWN0fSBmcm9tIFwiLi90eXBlc1wiO1xuXG4vLyBub2luc3BlY3Rpb24gSlNVbnVzZWRMb2NhbFN5bWJvbHNcbmV4cG9ydCBmdW5jdGlvbiBoYXZlTWl4aW48TSBleHRlbmRzIE1peGluPGFueSwgYW55PiwgQ2xhc3MgZXh0ZW5kcyBBbnlPYmplY3QgfCBhbnkgPSBuZXZlcj4oXG4gICAgdjogQW55T2JqZWN0LFxuICAgIG1peGluOiBNLFxuICAgIHZDbGFzcz86IENsYXNzXG4pOiB2IGlzIChcbiAgICBDaGVja05ldmVyPENsYXNzLFxuICAgICAgICBJVXNlTWl4aW5zPENsYXNzLCBNPixcbiAgICAgICAgTWl4aW5zUHJvcE9iamVjdDxNPlxuPikge1xuICAgIHJldHVybiB0eXBlb2YgdiA9PT0gXCJvYmplY3RcIiAmJiAnbWl4aW5zJyBpbiB2ICYmIHR5cGVvZiB2Lm1peGlucyA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgbWl4aW4ubWl4aW5OYW1lIGluIHYubWl4aW5zICYmIHR5cGVvZiB2Lm1peGluc1ttaXhpbi5taXhpbk5hbWVdID09PSAnb2JqZWN0Jztcbn1cblxuLy8gbm9pbnNwZWN0aW9uIEpTVW51c2VkTG9jYWxTeW1ib2xzXG5leHBvcnQgZnVuY3Rpb24gaGF2ZU1peGluczxNaXhpbnMgZXh0ZW5kcyBBcnJheTxNaXhpbjxhbnksIGFueT4+LCBDbGFzcyBleHRlbmRzIEFueU9iamVjdCB8IGFueSA9IG5ldmVyPihcbiAgICB2OiBBbnlPYmplY3QsXG4gICAgbWl4aW5zOiBNaXhpbnMsXG4gICAgdkNsYXNzPzogQ2xhc3MsXG4pOiB2IGlzIChcbiAgICBDaGVja05ldmVyPENsYXNzLFxuICAgICAgICBJVXNlTWl4aW5zPENsYXNzLCBNaXhpbnNbMF0sIE1peGluc1sxXSwgTWl4aW5zWzJdLCBNaXhpbnNbM10sIE1peGluc1s0XT4sXG4gICAgICAgIE1peGluc1Byb3BPYmplY3Q8TWl4aW5zWzBdLCBNaXhpbnNbMV0sIE1peGluc1syXSwgTWl4aW5zWzNdLCBNaXhpbnNbNF0+XG4+KSB7XG4gICAgY29uc3QgYmFzZUNoZWNrID0gdHlwZW9mIHYgPT09IFwib2JqZWN0XCIgJiYgJ21peGlucycgaW4gdiAmJiB0eXBlb2Ygdi5taXhpbnMgPT09ICdvYmplY3QnO1xuXG4gICAgaWYgKCFiYXNlQ2hlY2spIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgbWl4aW4gb2YgbWl4aW5zKSB7XG4gICAgICAgIGlmIChoYXZlTWl4aW4odiwgbWl4aW4sIHZDbGFzcykgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gaXNNaXhpbjxNIGV4dGVuZHMgSU1peGluQmFzZTxhbnk+ID0gSU1peGluQmFzZTxhbnk+Pih2YWx1ZTogYW55KTogdmFsdWUgaXMgTSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgdHlwZW9mIHZhbHVlPy5taXhpbk5hbWUgPT09ICdzdHJpbmcnICYmXG4gICAgICAgIHR5cGVvZiB2YWx1ZT8udGFyZ2V0ID09PSAnb2JqZWN0JyAmJlxuICAgICAgICB0eXBlb2YgdmFsdWU/LnRhcmdldD8ubWl4aW5zID09PSAnb2JqZWN0JyAmJlxuICAgICAgICB2YWx1ZT8ubWl4aW5OYW1lIGluIHZhbHVlPy50YXJnZXQ/Lm1peGlucztcbn1cblxuLy8vIGFzc2VydHMgZnVuY3Rpb25zXG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRIYXZlTWl4aW48TSBleHRlbmRzIE1peGluPGFueSwgYW55PiwgQ2xhc3MgZXh0ZW5kcyBBbnlPYmplY3QgfCBhbnkgPSBuZXZlcj4oXG4gICAgdjogQW55T2JqZWN0LFxuICAgIG1peGluOiBNLFxuICAgIHZDbGFzcz86IENsYXNzLFxuICAgIGVycm9yPzogc3RyaW5nIHwgRXJyb3IsXG4pOiBhc3NlcnRzIHYgaXMgKFxuICAgIENoZWNrTmV2ZXI8Q2xhc3MsXG4gICAgICAgIElVc2VNaXhpbnM8Q2xhc3MsIE0+LFxuICAgICAgICBNaXhpbnNQcm9wT2JqZWN0PE0+XG4+KSB7XG4gICAgaWYgKGhhdmVNaXhpbih2LCBtaXhpbiwgdkNsYXNzKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IE1peGluQXNzZXJ0RXJyb3IoZXJyb3IgPz8gYFRoZSBvYmplY3QgZG9lcyBub3QgaGF2ZSBtaXhpbiAnJHttaXhpbi5taXhpbk5hbWV9J2ApO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydEhhdmVNaXhpbnM8TU0gZXh0ZW5kcyBBcnJheTxNaXhpbjxhbnksIGFueT4+LCBDbGFzcyBleHRlbmRzIEFueU9iamVjdCB8IGFueSA9IG5ldmVyPihcbiAgICB2OiBBbnlPYmplY3QsXG4gICAgbWl4aW5zOiBNTSxcbiAgICB2Q2xhc3M/OiBDbGFzcyxcbiAgICBlcnJvcj86IHN0cmluZyB8IEVycm9yLFxuKTogYXNzZXJ0cyB2IGlzIChcbiAgICBDaGVja05ldmVyPENsYXNzLFxuICAgICAgICBJVXNlTWl4aW5zPENsYXNzLCBNTVswXSwgTU1bMV0sIE1NWzJdLCBNTVszXSwgTU1bNF0sIE1NWzVdLCBNTVs2XSwgTU1bN10sIE1NWzhdLCBNTVs5XT4sXG4gICAgICAgIE1peGluc1Byb3BPYmplY3Q8TU1bMF0sIE1NWzFdLCBNTVsyXSwgTU1bM10sIE1NWzRdLCBNTVs1XSwgTU1bNl0sIE1NWzddLCBNTVs4XSwgTU1bOV0+XG4+KSB7XG4gICAgaWYgKGhhdmVNaXhpbnModiwgbWl4aW5zLCB2Q2xhc3MpID09PSBmYWxzZSkge1xuICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgTWl4aW5Bc3NlcnRFcnJvcihcbiAgICAgICAgICAgICAgICBlcnJvciA/PyBgVGhlIG9iamVjdCBkb2VzIG5vdCBoYXZlIG9uZSBvciBtb3JlIG9mIG1peGlucyAke21peGlucy5tYXAobSA9PiBgJyR7bS5taXhpbk5hbWV9J2ApLmpvaW4oJywgJyl9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7XG4gICAgQW55T2JqZWN0LFxuICAgIEJ1aWxkTWl4aW5zSW50ZXJzZWN0aW9uLFxuICAgIENvbmZpZ0NvbXBsZXgsXG4gICAgQ29uc3RydWN0b3IsXG4gICAgQ29uc3RydWN0b3JXaXRoU3RhdGljLFxuICAgIEV4dHJhY3RNaXhpbnNQcm9wLFxuICAgIE1peGluLFxuICAgIE1peGluRnVsbCxcbiAgICBtaXhpbnNBZnRlckluaXQsXG4gICAgTWl4aW5zUHJvcFxufSBmcm9tIFwiLi90eXBlc1wiO1xuXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5leHBvcnQgZnVuY3Rpb24gbWl4aW48TmFtZSBleHRlbmRzIHN0cmluZywgQ29uZmlnIGV4dGVuZHMgQW55T2JqZWN0LCBQYXJ0aWFsS2V5cyBleHRlbmRzIEFycmF5PGtleW9mIENvbmZpZz4gPSBbXT4oXG4gICAgY29uZmlnOiAoQ29uZmlnIHwgQ29uZmlnQ29tcGxleDxOYW1lLCBDb25maWcsIFBhcnRpYWxLZXlzPikgJiBUaGlzVHlwZTxNaXhpbkZ1bGw8TmFtZSwgQ29uZmlnPj5cbik6IE1peGluRnVsbDxOYW1lLCBDb25maWc+IHtcbiAgICBjb25zdCBjZmc6IENvbmZpZ0NvbXBsZXg8TmFtZSwgQ29uZmlnPiA9IGNvbmZpZyBhcyBhbnk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdGFyZ2V0OiB1bmRlZmluZWQgYXMgYW55LFxuICAgICAgICAuLi5jZmcsXG4gICAgfTtcbn1cblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuZXhwb3J0IGZ1bmN0aW9uIHVzZU1peGluc0Zvck9iamVjdDxUIGV4dGVuZHMgQW55T2JqZWN0LFxuICAgIE1peGlucyBleHRlbmRzIEFycmF5PE1peGluPGFueSwgYW55Pj4sXG4gICAgTTEgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4sXG4gICAgTTIgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNMyBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE00IGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4gICAgTTUgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNNiBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE03IGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4gICAgTTggZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNOSBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE0xMCBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgID4oXG4gICAgdGFyZ2V0OiBULFxuICAgIG0xOiBNMSwgbTI/OiBNMiwgbTM/OiBNMywgbTQ/OiBNNCwgbTU/OiBNNSwgbTY/OiBNNiwgbTc/OiBNNywgbTg/OiBNOCwgbTk/OiBNOSwgbTEwPzogTTEwLFxuKTogT21pdDxULCAnbWl4aW5zJz4gJlxuICAgIE9taXQ8QnVpbGRNaXhpbnNJbnRlcnNlY3Rpb248TTEsIE0yLCBNMywgTTQsIE01LCBNNiwgTTcsIE04LCBNOSwgTTEwPiwga2V5b2YgVD4gJlxuICAgIHsgbWl4aW5zOiBFeHRyYWN0TWl4aW5zUHJvcDxUPiAmIE1peGluc1Byb3A8W00xLCBNMiwgTTMsIE00LCBNNSwgTTYsIE03LCBNOCwgTTksIE0xMF0+IH0ge1xuICAgIGFwcGx5TWl4aW5zSW50ZXJuYWwoXG4gICAgICAgIHRhcmdldCxcbiAgICAgICAgdHJ1ZSxcbiAgICAgICAgbTEsIG0yLCBtMywgbTQsIG01LCBtNiwgbTcsIG04LCBtOSwgbTEwLFxuICAgICk7XG4gICAgcmV0dXJuIHRhcmdldCBhcyBhbnk7XG59XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VNaXhpbnM8Q3RvciBleHRlbmRzIENvbnN0cnVjdG9yPGFueT4sXG4gICAgSW5zdGFuY2UgZXh0ZW5kcyBJbnN0YW5jZVR5cGU8Q3Rvcj4sXG4gICAgQ3RvckFyZ3VtZW50cyBleHRlbmRzIENvbnN0cnVjdG9yUGFyYW1ldGVyczxDdG9yPixcbiAgICBOZXdJbnN0YW5jZSBleHRlbmRzIE9taXQ8SW5zdGFuY2UsICdtaXhpbnMnIHwgJ19fbV9iX3R5cGUnPiAmXG4gICAgICAgIE9taXQ8QnVpbGRNaXhpbnNJbnRlcnNlY3Rpb248TTEsIE0yLCBNMywgTTQsIE01LCBNNiwgTTcsIE04LCBNOSwgTTEwPiwga2V5b2YgSW5zdGFuY2U+ICZcbiAgICAgICAgeyBtaXhpbnM6IEV4dHJhY3RNaXhpbnNQcm9wPEluc3RhbmNlPiAmIE1peGluc1Byb3A8W00xLCBNMiwgTTMsIE00LCBNNSwgTTYsIE03LCBNOCwgTTksIE0xMF0+IH0sXG4gICAgTTEgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4sXG4gICAgTTIgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNMyBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE00IGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4gICAgTTUgZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNNiBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE03IGV4dGVuZHMgTWl4aW48YW55LCBhbnk+ID0gbmV2ZXIsXG4gICAgTTggZXh0ZW5kcyBNaXhpbjxhbnksIGFueT4gPSBuZXZlcixcbiAgICBNOSBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgIE0xMCBleHRlbmRzIE1peGluPGFueSwgYW55PiA9IG5ldmVyLFxuICAgID4oXG4gICAga2xhc3M6IEN0b3IsXG4gICAgbTE6IE0xLCBtMj86IE0yLCBtMz86IE0zLCBtND86IE00LCBtNT86IE01LCBtNj86IE02LCBtNz86IE03LCBtOD86IE04LCBtOT86IE05LCBtMTA/OiBNMTAsXG4pOiBDb25zdHJ1Y3RvcldpdGhTdGF0aWM8TmV3SW5zdGFuY2UsIEN0b3I+ICYgeyBfX21fYl90eXBlOiBDdG9yIH0ge1xuICAgIHJldHVybiBjbGFzcyBleHRlbmRzIGtsYXNzIHtcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnZhcmlhYmxlLW5hbWVcbiAgICAgICAgc3RhdGljIF9fbV9iX3R5cGUgPSBrbGFzcztcblxuICAgICAgICBjb25zdHJ1Y3RvciguLi5hcmdzOiBhbnlbXSkge1xuICAgICAgICAgICAgc3VwZXIoLi4uYXJncyk7XG4gICAgICAgICAgICBhcHBseU1peGluc0ludGVybmFsKFxuICAgICAgICAgICAgICAgIHRoaXMgYXMgYW55LFxuICAgICAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICAgICAgbTEsIG0yLCBtMywgbTQsIG01LCBtNiwgbTcsIG04LCBtOSwgbTEwLFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH0gYXMgYW55O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlNaXhpbnM8VCBleHRlbmRzIEFueU9iamVjdCwgTWl4aW5zIGV4dGVuZHMgQXJyYXk8TWl4aW48YW55LCBhbnk+Pj4oXG4gICAgdGFyZ2V0OiBULCAuLi5taXhpbnM6IE1peGluc1xuKTogdm9pZCB7XG4gICAgcmV0dXJuIGFwcGx5TWl4aW5zSW50ZXJuYWwodGFyZ2V0LCBmYWxzZSwgLi4ubWl4aW5zKTtcbn1cblxuZnVuY3Rpb24gbWl4aW5nUHJvcHM8VCBleHRlbmRzIEFueU9iamVjdCwgRVggZXh0ZW5kcyB0cnVlIHwgZmFsc2U+KFxuICAgIHByb3BlcnR5RGVzY3JpcHRvcnM6IFByb3BlcnR5RGVzY3JpcHRvck1hcCwgdGFyZ2V0OiBULCBtaXhpbjogTWl4aW48YW55LCBhbnk+XG4pIHtcbiAgICBmb3IgKGNvbnN0IHByb3BOYW1lIG9mIE9iamVjdC5rZXlzKHByb3BlcnR5RGVzY3JpcHRvcnMpKSB7XG4gICAgICAgIGNvbnN0IHByb3BEZXNjcmlwdGlvbiA9IHByb3BlcnR5RGVzY3JpcHRvcnNbcHJvcE5hbWVdO1xuXG4gICAgICAgIGlmICghKHByb3BOYW1lIGluIHRhcmdldCkpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcHJvcERlc2NyaXB0aW9uLnZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BOYW1lLCB7XG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHdyaXRhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUodGhpczogdHlwZW9mIHRhcmdldCwgLi4uYXJnczogYW55W10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtaXhpbltwcm9wTmFtZV0oLi4uYXJncyk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHByb3BEZXNjcmlwdGlvbi5nZXQgfHwgcHJvcERlc2NyaXB0aW9uLnNldCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZXM6IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChwcm9wRGVzY3JpcHRpb24uZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMuZ2V0ID0gZnVuY3Rpb24odGhpczogdHlwZW9mIHRhcmdldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1peGluW3Byb3BOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHByb3BEZXNjcmlwdGlvbi5zZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5zZXQgPSBmdW5jdGlvbih0aGlzOiB0eXBlb2YgdGFyZ2V0LCB2YWx1ZTogYW55KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtaXhpbltwcm9wTmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BOYW1lLCBhdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgUmVmbGVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIHByb3BOYW1lLCB7XG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGdldCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtaXhpbltwcm9wTmFtZV07XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHNldCh2YWx1ZTogYW55KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtaXhpbltwcm9wTmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gYXBwbHlNaXhpbnNJbnRlcm5hbDxUIGV4dGVuZHMgQW55T2JqZWN0LCBFWCBleHRlbmRzIHRydWUgfCBmYWxzZSwgTWl4aW5zIGV4dGVuZHMgQXJyYXk8TWl4aW48YW55LCBhbnk+Pj4oXG4gICAgdGFyZ2V0OiBULCBleHRlbmRGcm9tTWl4aW5zOiBFWCwgLi4ubWl4aW5zOiBNaXhpbnNcbik6IHZvaWQge1xuICAgIGlmICh0eXBlb2YgdGFyZ2V0Lm1peGlucyAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgKHRhcmdldC5taXhpbnMgYXMgQW55T2JqZWN0KSA9IHt9O1xuICAgIH1cblxuICAgIG1peGlucyA9IG1peGlucy5maWx0ZXIobSA9PiAhIW0pIGFzIE1peGlucztcblxuICAgIGZvciAoY29uc3QgbWl4aW5PcmlnIG9mIG1peGlucykge1xuICAgICAgICBjb25zdCBtaXhpbiA9IHsuLi5taXhpbk9yaWd9O1xuXG4gICAgICAgIGNvbnN0IG1peGluTmFtZSA9IG1peGluLm1peGluTmFtZTtcbiAgICAgICAgKHRhcmdldC5taXhpbnMgYXMgQW55T2JqZWN0KVttaXhpbk5hbWVdID0gbWl4aW47XG4gICAgICAgIG1peGluLnRhcmdldCA9IHRhcmdldCBhcyBhbnk7XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBtaXhpbiBvZiBPYmplY3QudmFsdWVzKHRhcmdldC5taXhpbnMgYXMgUmVjb3JkPHN0cmluZywgTWl4aW48YW55LCBhbnk+PikpIHtcbiAgICAgICAgaWYgKCdzZXR1cCcgaW4gbWl4aW4gJiYgdHlwZW9mIG1peGluLnNldHVwID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjb25zdCBzZXR1cFJlc3VsdCA9IG1peGluLnNldHVwKCk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHNldHVwUmVzdWx0ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHNldHVwUmVzdWx0KSkge1xuICAgICAgICAgICAgICAgICAgICBtaXhpbltrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGV4dGVuZEZyb21NaXhpbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IG1peGFibGVzID0gZ2V0TWl4YWJsZXMobWl4aW4pO1xuXG4gICAgICAgICAgICBtaXhpbmdQcm9wcyhtaXhhYmxlcywgdGFyZ2V0LCBtaXhpbik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IG1peGluIG9mIE9iamVjdC52YWx1ZXModGFyZ2V0Lm1peGlucyBhcyBSZWNvcmQ8c3RyaW5nLCBNaXhpbjxhbnksIGFueT4+KSkge1xuICAgICAgICBtaXhpbi5pbml0ICYmIG1peGluLmluaXQoKTtcbiAgICB9XG5cbiAgICBpZiAobWl4aW5zQWZ0ZXJJbml0IGluIHRhcmdldCAmJiB0eXBlb2YgdGFyZ2V0W21peGluc0FmdGVySW5pdF0gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGFyZ2V0W21peGluc0FmdGVySW5pdF0oKTtcbiAgICB9XG5cbiAgICAvLyByZXR1cm4gdGFyZ2V0O1xufVxuXG5jb25zdCBub1Blcm1pdGVuTWl4YWJsZVByb3BlcnRpZXMgPSBbJ19fcHJvdG9fXycsICdpbml0JywgJ3NldHVwJywgJ3RhcmdldCcsICdtaXhpbk5hbWUnXTtcblxuLyoqXG4gKiBSZXR1cm5zIGEgbWFwIG9mIG1peGFibGVzLiBUaGF0IGlzIHRoaW5ncyB0aGF0IGNhbiBiZSBtaXhlZCBpblxuICovXG5mdW5jdGlvbiBnZXRNaXhhYmxlcyhvYmo6IG9iamVjdCk6IFByb3BlcnR5RGVzY3JpcHRvck1hcCB7XG4gICAgY29uc3QgbWFwOiBQcm9wZXJ0eURlc2NyaXB0b3JNYXAgPSB7fTtcbiAgICBjb25zdCBwcm9wTmFtZXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmopLmZpbHRlcihpID0+IG5vUGVybWl0ZW5NaXhhYmxlUHJvcGVydGllcy5pbmNsdWRlcyhpKSA9PT0gZmFsc2UpO1xuXG4gICAgZm9yIChjb25zdCBwcm9wTmFtZSBvZiBwcm9wTmFtZXMpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBwcm9wTmFtZSk7XG5cbiAgICAgICAgaWYgKGRlc2NyaXB0b3IgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBtYXBbcHJvcE5hbWVdID0gZGVzY3JpcHRvcjtcbiAgICB9XG5cbiAgICByZXR1cm4gbWFwO1xufVxuIl0sIm5hbWVzIjpbIm1peGluc0FmdGVySW5pdCIsIk1peGluQXNzZXJ0RXJyb3IiLCJFcnJvciIsImhhdmVNaXhpbiIsInYiLCJtaXhpbiIsInZDbGFzcyIsIm1peGlucyIsIm1peGluTmFtZSIsImhhdmVNaXhpbnMiLCJpc01peGluIiwidmFsdWUiLCJ0YXJnZXQiLCJhc3NlcnRIYXZlTWl4aW4iLCJlcnJvciIsImFzc2VydEhhdmVNaXhpbnMiLCJtYXAiLCJtIiwiam9pbiIsImNvbmZpZyIsImNmZyIsInVuZGVmaW5lZCIsInVzZU1peGluc0Zvck9iamVjdCIsIm0xIiwibTIiLCJtMyIsIm00IiwibTUiLCJtNiIsIm03IiwibTgiLCJtOSIsIm0xMCIsImFwcGx5TWl4aW5zSW50ZXJuYWwiLCJ1c2VNaXhpbnMiLCJrbGFzcyIsIl9hIiwiW29iamVjdCBPYmplY3RdIiwiYXJncyIsInN1cGVyIiwidGhpcyIsImFwcGx5TWl4aW5zIiwibWl4aW5nUHJvcHMiLCJwcm9wZXJ0eURlc2NyaXB0b3JzIiwicHJvcE5hbWUiLCJPYmplY3QiLCJrZXlzIiwicHJvcERlc2NyaXB0aW9uIiwiUmVmbGVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiZ2V0Iiwic2V0IiwiYXR0cmlidXRlcyIsImV4dGVuZEZyb21NaXhpbnMiLCJmaWx0ZXIiLCJtaXhpbk9yaWciLCJ2YWx1ZXMiLCJzZXR1cCIsInNldHVwUmVzdWx0Iiwia2V5IiwiZW50cmllcyIsImdldE1peGFibGVzIiwiaW5pdCIsIm5vUGVybWl0ZW5NaXhhYmxlUHJvcGVydGllcyIsIm9iaiIsInByb3BOYW1lcyIsImdldE93blByb3BlcnR5TmFtZXMiLCJpIiwiaW5jbHVkZXMiLCJkZXNjcmlwdG9yIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIl0sIm1hcHBpbmdzIjoib0VBMkhPLE1BQU1BLGdCQUFrQixzQkFXbEJDLHlCQUF5QkMsZ0JDbkl0QkMsVUFDWkMsRUFDQUMsRUFDQUMsR0FNQSxNQUFvQixpQkFBTkYsR0FBa0IsV0FBWUEsR0FBeUIsaUJBQWJBLEVBQUVHLFFBQ3RERixFQUFNRyxhQUFhSixFQUFFRyxRQUErQyxpQkFBOUJI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
